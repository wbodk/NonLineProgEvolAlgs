## Метод прямой замены

Рассматривается критерий оптимальности (целевая функция) вида

$$
y=f(\underline{x}),
$$

где $\underline{x}=[x_1, x_2, \ldots, x_n]^T$ - вектор переменных. В постановке задачи участвуют уравнения ограничения типа равенства

$$
h_i(\underline{x})=0, \quad i=1, \ldots, m,
$$

где $m>n$.

## Задачи

### Task 1.1
Найти минимум функции $f(\underline{x})=2x_1^2 + 3x_2^2$ с ограничением $ h(\underline{x}): x_1 + x_2 - 4 = 0 $ используя метод замены.

Решение

Из уравнения ограничения можно выразить переменную $x_1$

$$
x_1 = 4 - x_2, \quad (1)
$$

подставив это в критериальную функцию, получим

$$
f(x_2) = 2(4 - x_2)^2 + 3x_2^2 = 2(16 - 8x_2 + x_2^2) + 3x_2^2 = 5x_2^2 - 16x_2 + 32.
$$

Исследование необходимых и достаточных условий экстремума сводится к нахождению первой и второй производной по оставшейся переменной $x_2$

$$
\frac{\partial f}{\partial x_2} = 10x_2 - 16 = 0 \Rightarrow x_2^* = \frac{8}{5},
$$

подставив это в (1), получим

$$
x_1^* = 4 - \frac{8}{5} = \frac{12}{5}.
$$

Исследование знака второй производной в полученной стационарной точке

$$
\frac{\partial^2 f}{\partial x_2^2} = 10 > 0,
$$

позволяет заключить, что стационарная точка $\mathbf{x}^* = \left[\frac{12}{5}, \frac{8}{5}\right]^T$ представляет собой минимум функции.

### Task 1.2
Применение метода замены для определения точки, в которой функция
$$
f(x) = 6x_1 + 4x_2 + 2x_3 - 3x_1^2 - 2x_2^2-
\frac{1}{3}
x_3^2
$$
имеет максимум
при ограничении $h(\underline{x}): x_1 + x_2 + x_3 = 5$.

Решение.

Из уравнения ограничения следует

$$
x_3 = 5 - x_1 - x_2, \quad (2)
$$

и подстановкой этого в критериальную функцию получаем

$$
f(\underline{x}) = 6x_1 + 4x_2 + 2(5 - x_1 - x_2) - 3x_1^2 - 2x_2^2-\frac{1}{3}(5 - x_1 - x_2)^2=\frac{22}{3}x_1 + \frac{16}{3}x_2 + \frac{5}{3}-\frac{10}{3}x_1^2- \frac{7}{3}x_2^2-\frac{2}{3}x_1x_2
$$
Путем уравнивания первых производных по переменным $x_1$ и $x_2$ с нулем получаем систему уравнений

$$\begin{cases}
\frac{\partial f}{\partial x_1} = \frac{22}{3} - \frac{20}{3}x_1 - \frac{2}{3}x_2 = 0\\
\frac{\partial f}{\partial x_2} = \frac{16}{3} - \frac{14}{3}x_2 - \frac{2}{3}x_1 = 0,
\end{cases}$$

решениями которых являются $x_1^* = 1$ и $x_2^* = 1$. Подставив их в (2), получаем

$$
x_3^* = 5 - 1 - 1 = 3.
$$

Полученная стационарная точка $x^* = [1, 1, 3]^T$ представляет максимум функции, что подтверждается исследованием достаточных условий, а именно формированием гессиана
$$
H=
\begin{bmatrix}
\frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} \\
\frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2}
\end{bmatrix}
=
\begin{bmatrix}
-\frac{20}{3} & -\frac{2}{3} \\
-\frac{2}{3} & -\frac{14}{3}
\end{bmatrix},
$$

а затем вычислением главных миноров
$$
 D_1 = -\frac{20}{3} < 0
$$
$$
 D_2 = \frac{276}{9} > 0
$$


Поскольку $D_1 < 0$ и $D_2 > 0$, заключаем, что матрица $H$ отрицательно определена, и следовательно, точка $x^* = [1, 1, 3]^T$ представляет максимум функции.

### Task 1.3
Контейнер требуется иметь ширину $x$, длину $2x$, а его объем должен составлять $10м^3$. Стоимость материала для дна составляет $10 \, €/м^2$, а для стен - $6 \, €/м^2$. Каковы размеры контейнера, который будет наименее затратным?

![Slika 1](slika1.png)
Контейнер размера $2x \times x \times h$

#### Решение.

Для определения размеров контейнера, который является наименее затратным для производства, формируется критерий оптимальности в виде

$$
f(x, h) = 2x \cdot x \cdot 10 + (2x \cdot h \cdot 2 + x \cdot h \cdot 2) \cdot 6,
$$

где первое слагаемое представляет расходы на изготовление дна контейнера, а второе - расходы на изготовление боковых сторон контейнера. Упорядочивание предыдущего выражения приводит к

$$
f(x, h) = 20x^2 + 36xh.   \tag{3}
$$

Уравнение ограничения формируется на основе условия задачи (объем должен быть равен $10 м^3$)

$$
V = 2x \cdot x \cdot h = 2x^2 \cdot h = 10 \Rightarrow h = \frac{5}{x^2}.   \tag{4}
$$

Подставив (4) в уравнение (3), получаем

$$
f(x) = 20x^2 + 36x \cdot \frac{5}{x^2} = 20x^2 + 180x^{-1}.   \tag{5}
$$

Дальнейшая процедура исследования необходимых и достаточных условий экстремума аналогична предыдущим примерам.

$$
\begin{aligned}
\frac{\partial f}{\partial x} &= 40x - 180x^{-2} = 0 \\
&\Rightarrow x^* = \sqrt[3]{\frac{180}{40}} \approx 1.65.
\end{aligned}
$$

Подставив полученное значение в (5), получаем

$$
h^* = \frac{5}{1.65^2} \approx 1.83.
$$

На основе знака второй производной

$$
\frac{\partial^2 f}{\partial x^2} = 40 + 2 \cdot 180 \cdot \frac{1}{x^3} = 120 > 0,
$$

можем заключить, что изготовление контейнера наименее затратно для полученных размеров $x^*$ и $h^*$. Общие затраты будут

$$
f(1.65, 1.83) = 20 \cdot 1.65^2 + 36 \cdot 1.65 \cdot 1.83 \approx 163.152.
$$

### Task 1.4
Определить оптимум функции $z(\underline{x}) = x_1^2 + x_2^2$ при ограничении $h(\underline{x}) : x_1 x_2 = 2$.

Решение

Из уравнения ограничения мы можем выразить

$$x_1 = \frac{2}{x_2}, \quad (5)$$

после чего, подставив это в критериальную функцию, получим

$$z(x_2) = \frac{4}{x_2^2} + x_2^2$$

Следует исследование необходимых условий, которое сводится к приравниванию первой производной полученной критериальной функции к нулю.

Комбинируя это с уравнением (5), получаем стационарные точки.

$$\frac{\partial z}{\partial x_2} = -\frac{8}{x_2^3} + 2x_2 = 0 \Rightarrow x_2^* = \pm \sqrt{2}.$$

Подставив это обратно в (5), получаем значения

$$x_1^* = \pm \sqrt{2},$$

так что стационарные точки A($\sqrt{2}, \sqrt{2}$) и B(-$\sqrt{2}, -\sqrt{2}$).

Исследованием знака второй производной

$$\frac{\partial^2 z}{\partial x_2^2} = \frac{24}{x_2^4} + 2 = 8 > 0,$$

мы можем заключить, что стационарные точки A($\sqrt{2}, \sqrt{2}$) и B(-$\sqrt{2}, -\sqrt{2}$) представляют минимумы.

### Task 1.5
Методом замены найти минимум функции $f(x_1, x_2) = x_1^2 + x_2^2$ при условии, что переменные $x_1$ и $x_2$ должны удовлетворять ограничению $h(x_1, x_2) : x_1 + x_2 = 4$.

#### Решение.

Используя уравнение ограничения, переменную $x_1$ можно выразить как

$$x_1 = 4 - x_2, \quad (6)$$

после чего, подставив это в критериальную функцию, получаем

$$f(x_2) = (4 - x_2)^2 + x_2^2 = 16 - 8x_2 + x_2^2 + x_2^2 = 2x_2^2 - 8x_2 + 16.$$

Уравниванием первой производной по переменной $x_2$ с нулем получаем

$$\frac{\partial f}{\partial x_2} = 4x_2 - 8 = 0 \Rightarrow x_2^* = 2.$$

Подставив полученное значение в (6), получаем

$$x_1^* = 4 - 2 = 2,$$

так что стационарная точка - A(2, 2). Так как вторая производная

$$\frac{\partial^2 f}{\partial x_2^2} = 4 > 0,$$

мы заключаем, что в точке A(2, 2) функция имеет минимум.

## Метод ограниченных вариаций

Как и в методе подстановки, рассматривается критериальная функция вида
$$y = f(x_1, x_2, \ldots, x_n),$$
при условии, что уравнения ограничения имеют вид
$$h_i(x_1, x_2, \ldots, x_n) = 0, \quad i = 1, \ldots, m,$$
и выполняется условие $m > n$. На основе перечисленного формируется Якобиева матрица, уравнивая которую с нулем
$$
J_k =
\begin{vmatrix}
\frac{\partial f}{\partial x_k} & \frac{\partial f}{\partial x_1} & \ldots & \frac{\partial f}{\partial x_m} \\
\frac{\partial h_1}{\partial x_k} & \frac{\partial h_1}{\partial x_1} & \ldots & \frac{\partial h_1}{\partial x_m} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial h_m}{\partial x_k} & \frac{\partial h_m}{\partial x_1} & \ldots & \frac{\partial h_m}{\partial x_m} \\
\end{vmatrix}
= 0, \quad k = m+1, \ldots, n
$$
получаются необходимые условия экстремума функции многих переменных с ограничениями типа равенства.

## Задачи

### Task2.1
Методом ограниченных вариаций найти стационарные точки функции
$y(x_1, x_2) = x_2 - x_1^2$
при ограничении
$h(x_1, x_2) : 1 - x_1^2 - x_2^2 = 0.$

#### Решение.

Количество переменных $n=2$, а количество ограничений $m=1$, следовательно, нам нужна только одна Якобиева матрица (при $k=2$):

$$J_2 =
\begin{vmatrix}
\frac{\partial y}{\partial x_2} & \frac{\partial y}{\partial x_1} \\
\frac{\partial h}{\partial x_2} & \frac{\partial h}{\partial x_1}
\end{vmatrix}
=
\begin{vmatrix}
1 & -2x_1 \\
-2x_2 & -2x_1
\end{vmatrix}
= -2x_1 - 4x_1x_2.$$

Решая полученное уравнение, получаем:
$$-2x_1(1 + 2x_2) = 0 \Rightarrow x_1^* = 0 \, \text{или} \, x_2^* = -\frac{1}{2}.$$

Сменой переменных в уравнении ограничения получаем два случая:

I. $x_1^* = 0 \Rightarrow x_2^* = \pm 1$, в первом случае получаем две стационарные точки $A(0, 1)$ и $B(0, -1)$;

II. $x_2^* = -\frac{1}{2} \Rightarrow x_1^* = \pm \frac{\sqrt{3}}{2}$, во втором случае получаем еще две стационарные точки $C\left(\frac{\sqrt{3}}{2}, -\frac{1}{2}\right)$ и $D\left(-\frac{\sqrt{3}}{2}, -\frac{1}{2}\right)$

### Task 2.2
Методом ограниченных вариаций найти стационарные точки функции
$y(x_1, x_2, x_3) = 7x_1 - 6x_2 + 4x_3$
при ограничении
$h(x_1, x_2, x_3) : x_1^2 + 2x_2^2 + 3x_3^2 - 1 = 0.$

#### Решение.

Количество переменных $n=3$, а количество ограничений $m=1$, следовательно, нам нужны две Якобиевы матрицы ($k=2$ и $k=3$):

$$J_2 =
\begin{vmatrix}
\frac{\partial y}{\partial x_2} & \frac{\partial y}{\partial x_1} \\
\frac{\partial h}{\partial x_2} & \frac{\partial h}{\partial x_1}
\end{vmatrix}
=
\begin{vmatrix}
-6 & 7 \\
4x_2 & 2x_1
\end{vmatrix}
= -12x_1 - 28x_2 = 0,
$$

$$J_3 =
\begin{vmatrix}
\frac{\partial y}{\partial x_3} & \frac{\partial y}{\partial x_1} \\
\frac{\partial h}{\partial x_3} & \frac{\partial h}{\partial x_1}
\end{vmatrix}
=
\begin{vmatrix}
4 & 7 \\
6x_3 & 2x_1
\end{vmatrix}
= 8x_1 - 42x_3 = 0.
$$

Комбинируя полученные уравнения с уравнением ограничения, получаем систему уравнений:

$$
\begin{align*}
3x_1 + 7x_2 &= 0, \\
4x_1 - 21x_3 &= 0, \\
x_1^2 + 2x_2^2 + 3x_3^2 - 1 &= 0.
\end{align*}
$$

Решения этой системы уравнений:

$$
\begin{align*}
x_1^* &\approx \pm 0.823, \\
x_2^* &\approx \mp 0.353, \\
x_3^* &\approx \pm 0.157.
\end{align*}
$$

Следовательно, стационарные точки: $A(0.823, -0.353, 0.157)$ и $B(-0.823, 0.353, -0.157)$.

### Task 2.3
Методом ограниченных вариаций найти стационарные точки функции
$$y(x_1, x_2) = -2x_1^2 - x_2^2 + x_1x_2 + 8x_1 + 3x_2$$
при ограничении
$$h(x_1, x_2) : 3x_1 + x_2 - 10 = 0.$$

#### Решение.

Количество переменных $n=2$, а количество ограничений $m=1$, поэтому нам нужна одна Якобиева матрица ($k=2$):

$$J_2 =
\begin{vmatrix}
\frac{\partial y}{\partial x_2} & \frac{\partial y}{\partial x_1} \\
\frac{\partial h}{\partial x_2} & \frac{\partial h}{\partial x_1}
\end{vmatrix}
=
\begin{vmatrix}
-2x_2 + x_1 + 3 & 7x_1 - 7x_2 + 1 \\
1 & 3
\end{vmatrix}.
$$

На основе полученной матрицы и уравнения ограничения, составляем систему уравнений:

$$
\begin{align*}
-2x_2 + x_1 + 3 &= 0, \\
7x_1 - 7x_2 + 1 &= 0, \\
3x_1 + x_2 - 10 &= 0.
\end{align*}
$$

Решение этой системы уравнений:

$$x_1^* = \frac{69}{28}, \quad x_2^* = \frac{73}{28}.$$

Следовательно, стационарная точка $A\left(\frac{69}{28}, \frac{73}{28}\right)$.

### Task2.4
Методом ограниченных вариаций определить стационарные точки функции $f(x) = x_1^2 + x_2^2 + x_3^2$
при ограничениях
$$h_1(x) : x_1 + 2x_2 = 2$$
и
$$h_2(x) : x_1^2 + 2x_2^2 + 2x_3^2 = 2.$$

#### Решение.

Первый шаг - преобразование уравнений ограничения:
$$h_1(x) : x_1 + 2x_2 = 2 \Rightarrow x_1 + 2x_2 - 2 = 0$$

$$h_2(x) : x_1^2 + 2x_2^2 + 2x_3^2 = 2 \Rightarrow x_1^2 + 2x_2^2 + 2x_3^2 - 2 = 0.$$

Количество переменных $n=3$, а количество ограничений $m=2$, поэтому нам нужна одна Якобиева матрица ($k=3$):
$$J_3 =
\begin{vmatrix}
\frac{\partial f}{\partial x_3} & \frac{\partial f}{\partial x_1} & \frac{\partial f}{\partial x_2} \\
\frac{\partial h_1}{\partial x_3} & \frac{\partial h_1}{\partial x_1} & \frac{\partial h_1}{\partial x_2} \\
\frac{\partial h_2}{\partial x_3} & \frac{\partial h_2}{\partial x_1} & \frac{\partial h_2}{\partial x_2}
\end{vmatrix}
=
\begin{vmatrix}
2x_3 & 2x_1 & 2x_2 \\
0 & 1 & 2 \\
4x_3 & 2x_1 & 4x_2
\end{vmatrix}
= 2x_3\begin{vmatrix}
1 & 2\\
2x_1 & 4x_2
\end{vmatrix}
+ 4x_3
\begin{vmatrix}
2x_1 & 2x_2\\
1 & 2
\end{vmatrix}
= 8x_1x_3 = 0 \quad \Rightarrow \quad x_1^* = 0 \lor x_3^* = 0
$$

Решая систему уравнений $$h_1(x) : x_1 + 2x_2 - 2 = 0$$ и $$h_2(x) : x_1^2 + 2x_2^2 + 2x_3^2 - 2 = 0$$, получаем два случая:

I. $x_3^* = 0$, что приводит к системе
$$
\begin{cases}
1 & x_1 + 2x_2 - 2 = 0, \\
2 & x_1^2 + 2x_2^2 - 2 = 0.
\end{cases}
$$

Решением данной системы является $x_1^* = 0$, $x_2^* = 1$.

II. $x_3^* \neq 0$, что приводит к системе
$$
\begin{cases}
1 & x_1 + 2x_2 - 2 = 0, \\
2 & x_1^2 + 2x_2^2 + 2x_3^2 - 2 = 0.
\end{cases}
$$

Решением данной системы является $x_1^* = \frac{4}{3}$, $x_2^* = \frac{1}{3}$.

Таким образом, стационарные точки:
$A(0, 1, 0)$ (случай I) и $B\left(\frac{4}{3}, \frac{1}{3}, 0\right)$ (случай II)

### Задача 2:

В рамках эксперимента было проведено измерение выхода процесса в моменты времени $$ t = [0, 1, 2, 3] $$, и сенсор выхода процесса показал значения $$ y = [5, 0, 6, 8] $$. Необходимо решить оптимизационную задачу и найти параболу (ат^2 + bт + c), которая наилучшим образом описывает поведение выхода процесса.

$$ t = [0, 1, 2, 3] $$
$$ y = [5, 0, 6, 8] $$

Известно, что уравнение параболы $$ y(t) = at^2 + bt + c $$. Используя уравнение параболы, мы можем определить функцию $$ y(t) $$ для каждого значения $$ t $$.

1. $$ y_0 : c = 5 $$
2. $$ y_1 : a + b + c = 0 $$
3. $$ y_2 : 4a + 2b + c = 6 $$
4. $$ y_3 : 9a + 3b + c = 8 $$

С использованием метода наименьших квадратов формируем расширенный критерий оптимальности $$ F $$:

$$ F = (c - 5)^2 + (a + b + c)^2 + (4a + 2b + c - 6)^2 + (9a + 3b + c - 8)^2 $$

Необходимо найти частные производные по всем неизвестным:

$$ \frac{\partial F}{\partial a} = 2(a + b + c) + 8(4a + 2b + c - 6) + 18(9a + 3b + c - 8) $$
$$ \frac{\partial F}{\partial b} = 2(a + b + c) + 4(4a + 2b + c - 6) + 6(9a + 3b + c - 8) $$
$$ \frac{\partial F}{\partial c} = 2(c - 5) + 2(a + b + c) + 2(4a + 2b + c - 6) + 2(9a + 3b + c - 8) $$

Получаем систему из трех уравнений:

$$ 196a + 72b + 28c - 192 = 0 $$
$$ 72a + 28b + 12c - 72 = 0 $$
$$ 28a + 12b + 8c - 38 = 0 $$

Решением этой системы получаем значения параметров:

$$ a = 1.75, \quad b = -3.75, \quad c = 4.25 $$

Парабола, которая наилучшим образом описывает поведение выхода процесса:

$$ y = 1.75t^2 - 3.75t + 4 $$