# Метод множителей Лагранжа и метод штрафных функций
## 1. Метод множителей Лагранжа
Оптимизационную задачу, которую мы решаем, формулируем следующим образом: найти экстремум функции 
$ f = f(x_1, x_2, ..., x_n) $
при условии, что ограничения 
$ g_k(x_1, ..., x_n) = 0, \quad k = 1, ..., m, \quad m<n $
### Task 1.1:
Методом множителей Лагранжа определяем стационарные точки функции $ f(x, y) = -2x^2 - y^2 + xy + 8x + 3y $ при ограничении $ g: 3x + y - 10 = 0 $ и исследуем их характер.

Формируем новый критерий оптимальности:
$$ L = -2x^2 - y^2 + xy + 8x + 3y + \lambda(3x + y - 10) $$
Необходимые условия:
$$ \frac{\partial L}{\partial x} = -4x + y + 8 + 3\lambda = 0 $$
$$ \frac{\partial L}{\partial y} = -2y + x + 3 + \lambda = 0 $$
$$ \frac{\partial L}{\partial \lambda} = 3x + y - 10 = 0 $$
Решением системы уравнений получаем значения:
$$ x^* = \frac{69}{28}, \quad y^* = \frac{73}{28} $$
Для исследования характера полученной стационарной точки мы должны рассмотреть достаточные условия.

Достаточные условия исследуем на основе определенности матрицы вторых производных Лагранжиана $ Q $.
$$ Q = \begin{bmatrix} -4 & 1 \\ 1 & -2 \end{bmatrix} $$
Определенность матрицы проверяем с использованием теоремы Сильвестра.

Главные миноры:
$$ D_1 = -4 < 0 $$
$$ D_2 = 8 - 1 = 7 > 0 $$
Мы заключаем, что матрица $ Q $ отрицательно определена, и стационарная точка A $\left(\frac{69}{28}, \frac{73}{28}\right)$ является максимумом.
### Task 1.2:
Пересечение конуса, описанного уравнением $z^2 = x^2 + y^2$, и плоскости $z = 1 + x + y$. Найти точку на кривой $C$, которая находится ближе всего к началу координат.

Цель - найти кратчайшее расстояние, поэтому критерием оптимальности для этой задачи будет $$(x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2$$.
$$ d = \sqrt{(x-0)^2 + (y-0)^2 + (z-0)^2} $$
Для упрощения расчетов, мы квадратируем критерий оптимальности, так как это расстояние и не может быть отрицательным.
$$ f(x, y, z) = x^2 + y^2 + z^2 $$
Ограничения:
$$ g_1: z^2 - x^2 - y^2 = 0 $$
$$ g_2: z - 1 - x - y = 0 $$
Новый критерий оптимальности:
$$ L = x^2 + y^2 + z^2 + \lambda_1(z^2 - x^2 - y^2) + \lambda_2(z - 1 - x - y) $$
Необходимые условия:
1. $\frac{\partial L}{\partial x} = 2x - 2x\lambda_1 - \lambda_2 = 0$
2. $\frac{\partial L}{\partial y} = 2y - 2y\lambda_1 - \lambda_2 = 0$
3. $\frac{\partial L}{\partial z} = 2z + 2z\lambda_1 + \lambda_2 = 0$
4. $\frac{\partial L}{\partial \lambda_1} = z^2 - x^2 - y^2 = 0$
5. $\frac{\partial L}{\partial \lambda_2} = z - 1 - x - y = 0$

Сложением уравнений (1) и (3) получаем:
$$ \lambda_1 = \frac{x+z}{x-z} $$
или
$$ \lambda_1 = \frac{y+z}{y-z} $$
Теперь мы можем приравнять полученные выражения для $\lambda_1$:
$$ \frac{x+z}{x-z} = \frac{y+z}{y-z} $$
Решив это уравнение, получим:
$$ z = 0 \quad \text{или} \quad y = x $$
1. $ z = 0 $\
    Для (4) и (5) уравнений получим:
    $$ x^2 + y^2 = 0 \quad \text{и} \quad x + y + 1 = 0 $$
    Подставив значение $ z = 0 $ в уравнение $ g_1 $, получим систему:
    $$\begin{cases}
    x^2 + y^2 = 0 \\
    x + y + 1 = 0
    \end{cases}$$
    Эта система не имеет реальных решений.

2. $ x = y $\
    Для (4) и (5) уравнений получим:
    $$ z^2 - 2x^2 = 0 \quad \text{и} \quad z - 1 - 2x = 0 $$
    Подставив значение $x = y$ в уравнение $ g_1 $, получим систему:
    $$\begin{cases}
    z^2 - 2x^2 = 0 \\
    z - 1 - 2x = 0
    \end{cases}$$
    Эта система имеет корни:
    $$x = -\frac{\sqrt{2}}{2}, \quad y = -\frac{\sqrt{2}}{2}, \quad z = \frac{1}{2} \\
    x = \frac{\sqrt{2}}{2}, \quad y = \frac{\sqrt{2}}{2}, \quad z = -\frac{1}{2}$$

Таким образом, полученные стационарные точки - $ A\left(-\frac{\sqrt{2}}{2}, -\frac{\sqrt{2}}{2}, \frac{1}{2}\right) $ и $ B\left(\frac{\sqrt{2}}{2}, \frac{\sqrt{2}}{2}, -\frac{1}{2}\right)$.

Чтобы определить, какая точка ближе к началу координат, мы можем вычислить расстояния от каждой точки до начала координат. Расстояние от точки A равно $d_A = 3.4142$, а от точки B - $d_B = 0.5858$.

Однако для окончательного заключения о том, какая точка ближе, необходимо провести дополнительные проверки на характер стационарных точек.

Матрица вторых производных $ Q $
$$ Q = \begin{bmatrix} 2-2\lambda_1 & 0 & 0 \\ 0 & 2-2\lambda_1 & 0 \\ 0 & 0 & 2+2\lambda_1 \end{bmatrix} $$
Определенность матрицы проверяем с использованием теоремы Сильвестра. Главные миноры:
$$ D_1 = 2 - 2\lambda_1 $$
$$ D_2 = (2-2\lambda_1)^2 $$
$$ D_3 = (2-2\lambda_1)^2 (2+2\lambda_1) $$
Теперь мы можем проверить определенность матрицы для полученных стационарных точек A и B. Величина $\lambda_1$ для точки A равна $\lambda_1 = -5.828$, а для точки B - $\lambda_1 = -0.1716$.

Для точки A:
$$ D_1 = 13.656 > 0 $$
$$ D_2 = 186.4863 > 0 $$
$$ D_3 = -1800.7 < 0 $$
Для точки B:
$$ D_1 = 2.3432 > 0 $$
$$ D_2 = 5.4906 > 0 $$
$$ D_3 = 9.0968 < 0 $$
Таким образом, матрица $ Q $ для точки A невыполнена (проведите дополнительное исследование для этой точки), в то время как матрица $ Q $ для точки B положительно определена. Следовательно, точка B является точкой минимума.
### Task 1.3
Метод множителей Лагранжа для определения стационарных точек

Рассмотрим функцию:
$$ f(x_1, x_2) = x_2^2 - 2x_1 - x_1^2 $$
с ограничением:
$$ g: x_1^2 + x_2^2 - 1 = 0 $$
Мы формируем новый критерий оптимальности:
$$ L = x_2^2 - 2x_1 - x_1^2 + \lambda(x_1^2 + x_2^2 - 1) $$
Необходимые условия:
1. $\frac{\partial L}{\partial x_1} = -2 - 2x_1 + 2\lambda x_1 = 0$
2. $\frac{\partial L}{\partial x_2} = 2x_2 + 2\lambda x_2 = 0$
3. $\frac{\partial L}{\partial \lambda} = x_1^2 + x_2^2 - 1 = 0$

Из уравнения (2) получаем:
$$ 2x_2(1 + \lambda) = 0 \implies x_2 = 0 \text{ или } \lambda = -1 $$
Таким образом, у нас есть два случая для нахождения стационарных точек.
### (a) $x_2 = 0$
Из уравнения (3) следует, что $x_1 = \pm 1$, поэтому у нас есть две стационарные точки:
- A(1, 0), $\lambda_A = 2$
- B(-1, 0), $\lambda_B = 0$
### (b) $\lambda = -1$
Из уравнения (1) получаем, что $x_1 = -\frac{1}{2}$, а из (3) получаем, что $x_2^2 = \frac{3}{4}$, поэтому у нас есть следующие две стационарные точки:
- $C\left(-\frac{1}{2}, \frac{\sqrt{3}}{2}\right)$, $\lambda_C = 1$
- $D\left(-\frac{1}{2}, -\frac{\sqrt{3}}{2}\right)$, $\lambda_D = 1$

Чтобы изучить характер полученных стационарных точек, нужно исследовать дополнительные условия.
### Матрица $Q$
$$ Q = \begin{bmatrix} 2\lambda - 2 & 0 \\ 0 & 2\lambda + 2 \end{bmatrix} $$
Определенность матрицы проверяется с использованием теоремы Сильвестра. Главные миноры:
$$ D_1 = 2\lambda - 2 $$
$$ D_2 = 4\lambda^2 - 4 $$
Подставим значения для каждой стационарной точки и $\lambda$:
### A:
$$ D_1 = -2, \quad D_2 = 0 $$
### B:
$$ D_1 = 2, \quad D_2 = 0 $$
### C:
$$ D_1 = 0, \quad D_2 = -3 $$
### D:
$$ D_1 = 0, \quad D_2 = -3 $$
Таким образом, стационарные точки A и B неопределены (провести дополнительное исследование для этих точек), в то время как стационарные точки C и D соответственно представляют собой максимум и минимум.
### Дополнительное исследование для точек A и B:
#### Формируем матрицу $\Delta$:
$$ \Delta = \begin{bmatrix} 2x_1 & 2x_2 \\ 2x_2 & 2\lambda + 2 \end{bmatrix} $$
#### Вычисляем определитель матрицы $\Delta$:
$$ |\Delta| = -4x_2^2(2\lambda - 2) - 4x_1^2(2\lambda + 2) = 0 $$
Решив уравнение, получаем значение $\mu$:
$$ \mu = 2 - 3\lambda $$
#### Подставляем значения $\mu$ в таблицу:
### A:
$$ \mu_A = -3, \quad \text{характер: неизвестен} $$
### B:
$$ \mu_B = -3, \quad \text{характер: неизвестен} $$
### C:
$$ \mu_C = -3, \quad \text{характер: максимум} $$
### D:
$$ \mu_D = -3, \quad \text{характер: максимум} $$
Таким образом, мы видим, что характер стационарных точек A и B неизвестен, а точки C и D представляют собой максимумы.
### Task 1.4
Нахождение наикратчайшего расстояния

Для поиска наикратчайшего расстояния между точкой (0, 1, 2) и параболоидом $z = x^2 + y^2$, используем критерий оптимальности:
$$ d = \sqrt{(x-0)^2 + (y-1)^2 + (z-2)^2} \Rightarrow f = d^2 = x^2 + (y-1)^2 + (z-2)^2 $$
с ограничением $g: x^2 + y^2 - z = 0$.

Формируем новый критерий оптимальности:
$$ L = x^2 + (y-1)^2 + (z-2)^2 + \lambda(x^2 + y^2 - z) $$
Необходимые условия:
1. $\frac{\partial L}{\partial x} = 2x + 2\lambda x = 0$
2. $\frac{\partial L}{\partial y} = 2(y-1) + 2\lambda y = 0$
3. $\frac{\partial L}{\partial z} = 2(z-2) - \lambda = 0$
4. $\frac{\partial L}{\partial \lambda} = x^2 + y^2 - z = 0$

Из уравнения (1) получаем:
$$ 2x(1 + \lambda) = 0 \Rightarrow x = 0 \text{ или } \lambda = -1 $$
Таким образом, у нас есть два случая для нахождения стационарных точек.
### (a) $x = 0$
Из уравнения (2) получаем $\lambda = 1 - \frac{y}{y-1}$, а из уравнения (3) получаем $\lambda = 2(z-2)$. Из уравнения (4) получаем $z = y^2$.

Подставив эти значения, получаем:
$$ 1 - \frac{y}{y-1} = 2(y^2-2) $$
Решив это уравнение, получаем значения $y$, а затем $z$ и $x$.
### (b) $\lambda = -1$
Из (2) получаем уравнение $2(y-1) - 2y = 0$, что невозможно, поэтому для этого случая стационарных точек нет.

Рассчитаем расстояния для полученных стационарных точек и определим, при какой точке достигается наименьшее расстояние.
### Матрица $Q$
$$ Q = \begin{bmatrix} 2 + 2\lambda & 0 & 0 \\ 0 & 2 + 2\lambda & 0 \\ 0 & 0 & 2 \end{bmatrix} $$
Определенность матрицы проверяется с использованием теоремы Сильвестра. Главные миноры:
$$ D_1 = 2\lambda + 2 $$
$$ D_2 = (2\lambda +2)^2 > 0 $$
$$ D_3 = 2(2\lambda +2)^2 > 0 $$
Теперь вычислим значения для каждой стационарной точки и $\lambda$:
### A:
$$ \lambda_A = -2, \quad D_1 = -2 $$
### B:
$$ \lambda_B = -0.274, \quad D_1 = 1.452 $$
### C:
$$ \lambda_C = -3, \quad D_1 = -5 $$
Таким образом, стационарные точки A и C неопределены (требуется дополнительное исследование), в то время как точка B представляет собой минимум.
### Дополнительное исследование для точек A и C:
#### Формируем матрицу $\Delta$:
$$ \Delta = \begin{bmatrix} 2x & 2(y-1) & 2(z-2) \\ 2(y-1) & 2\lambda + 2 & 0 \\ 2(z-2) & 0 & 2 \end{bmatrix} $$
#### Вычисляем определитель матрицы $\Delta$:
$$ |\Delta| = 0 $$
Поскольку определитель равен нулю, необходимо провести дополнительное исследование.
### A:
$$ \mu_A = -3, \quad \text{Характер: неизвестен} $$
### C:
$$ \mu_C = -3, \quad \text{Характер: неизвестен} $$
Таким образом, дополнительное исследование не позволяет определить характер точек A и C.
### 1.5 Задача для самостоятельной работы
Используя метод множителей Лагранжа, найдите стационарные точки для следующего критерия оптимальности:
$$ f(x, y) = e^{(x-1)y} $$
которые находятся на единичной окружности с центром в начале координат.
## Метод штрафных функций
Применяется для решения задач с ограничениями.
### Task 2.1
Применим метод штрафных функций для нахождения минимума функции $$y(x_1,x_2)=2x_1^2−7x_2^2$$​ при ограничении $$x_1+2x_2−5=0$$
Первый шаг - формирование модифицированного критерия оптимальности:
$$ F = 2x_1^2 - 7x_2^2 + P(x_1 + 2x_2 - 5)^2 $$
Стационарные точки ищутся так, будто ограничения отсутствуют:
1. $\frac{\partial F}{\partial x_1} = 4x_1 + 2P(x_1 + 2x_2 - 5) = 0$
2. $\frac{\partial F}{\partial x_2} = -7x_2 + 4P(x_1 + 2x_2 - 5) = 0$

Устраняя $P$, получаем:
$$ -4x_1 - 7x_2 = 0 $$
Так что $x_1 = -\frac{7}{4}x_2$. Подставляя это в первое уравнение:
$$ -7x_2 + P \left( \frac{20}{P} - 10 \right) = 0 $$
Решив это уравнение, получаем $x_2 = \frac{20}{P - 14}$.

Для больших значений параметра $P$ (когда $P \to \infty$), мы получаем $x_2^* = 20$, а $x_1^* = -35$.